\section{译者补充：经典电磁理论下的光学基础}\label{sec:译者补充：经典电磁理论下的光学基础}
\begin{remark}
    本节内容不是原书内容，而是译者根据《Optics》\citep{hecht2016optics}
    补充并参考\citet{OpticsChinese}翻译的，请酌情参考和斧正。
    本节内容只简要介绍相关基础概念和结论，
    并不像正式的物理和光学教材那样严谨，请读者批判性地看待本节内容。
    本节要求读者具备较好的微积分与电磁理论知识储备。
    此外读者需注意，本节遵循有关内容惯例采用右手坐标系，
    与正文pbrt采用的左手坐标系不同。
\end{remark}

\subsection{波动}\label{sub:波动}
光的本质是什么？光是波动现象还是粒子现象？
这个问题非常复杂。早在二十世纪，物理学家们就已经发现，
光的电磁理论的经典结论在微观层级上完全不成立。
然而当我们站在通常的大尺度视角下，电磁波及其经典理论已经够用了。
为了打好基础，我们从波的数学描述说起，它也适用于一切物理波。

\subsubsection*{一维波}
行进中的\keyindex{波}{wave}{}的一个本质特性是，
它是传播波的\keyindex{介质}{medium}{}的自持\keyindex{扰动}{disturbance}{}。
\keyindex{机械波}{mechanical wave}{wave\ 波}是
我们最熟悉的波，例如琴弦上的波、液体表面的波以及
空气中的\keyindex{声波}{sound wave}{wave\ 波}。
波还有纵波、横波之分。介质在波动方向上位移的是\keyindex{纵波}{longitudinal wave}{wave\ 波}。
介质位移的方向垂直于波动方向的是\keyindex{横波}{transverse wave}{wave\ 波}。
例如，声波是纵波；琴弦上的波、电磁波是横波。

波区别于粒子流的几个关键特征之一是，
扰动在前进，但实物介质并不前进。
就像风吹起滚滚麦浪，但麦穗只是原地摇摆。
\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.65\linewidth]{Pictures/chap08/longitudinalAndTransverseWave.eps}
    \caption{弹簧中的(a)纵波；(b)横波。}
    \label{fig:08ex02.0201}
\end{figure}

我们暂不追究扰动的本质，而专注研究描述波动的方程应该具备怎样的形式。
设某个这样的扰动$\psi$以恒定速度$v$沿正$x$方向运动。
既然扰动在运动，则它必然是位置和时间的函数：
\begin{align}
    \psi(x,t)=f(x,t)\, ,
\end{align}
其中$f(x,t)$对应于某个具体函数或波形。
如\reffig{08ex02.0203}(a)所示，一个脉冲在静止坐标系$S$中以速度$v$运动。
我们取定任意时刻$t$即可得到那个时刻波的\keyindex{剖面}{profile}{}，
就像脉冲经过时给它“拍照”。例如$t=0$有
\begin{align}
    \psi(x,t)\bigg|_{t=0}=f(x,0)=f(x)
\end{align}
表示0时刻波的剖面。
\begin{figure}[htb]
    \centering
    \includegraphics[width=0.5\linewidth]{Pictures/chap08/MovingReferenceFrame.eps}
    \caption{运动参考系。}
    \label{fig:08ex02.0203}
\end{figure}

现在，我们先只考虑传播时形状不变的波。
在一段时间$t$后，脉冲沿$x$轴前进了距离$vt$，其余不变。
如\reffig{08ex02.0203}(b)，我们引入新坐标系$S'$并与脉冲以相同速度$v$运动。
则在该坐标系中$\psi$不再是时间的函数，而是静止不变的剖面，即
\begin{align}
    \psi=f(x')\, ,
\end{align}
这意味着坐标系$S'$中的扰动在任意时刻$t$的形状，
都和$S$中$t=0$时两者具有同一原点时扰动的形状相同，如\reffig{08ex02.0203}(c)所示。
为了将上式改写为$S$中某静止观察者描述的形式，我们利用
\begin{align}
    x'=x-vt
\end{align}
得到
\begin{align}
    \psi(x,t)=f(x-vt)\, .
\end{align}
上式是一维\keyindex{波函数}{wave function}{wave\ 波}的最一般形式。
它描述了一个具有所需剖面形状$f(x)$的波，它以速度$v>0$沿正$x$方向运动。
相似地，如果波向负$x$方向运动，则上式应改写为
\begin{align}
    \psi(x,t)=f(x+vt)\, .
\end{align}
总之变量$x$和$t$一定作为一个整体变量$x\mp vt$出现。

\subsubsection*{波动微分方程}
接下来我们推导一维波动方程的形式，把$\psi(x,t)$对空间与时间的依赖关系联系起来。注意到
\begin{align}
    \frac{\partial x'}{\partial x}=\frac{\partial (x\mp vt)}{\partial x}=1\, ,
\end{align}
以及
\begin{align}
    \frac{\partial x'}{\partial t}=\mp v\, ,
\end{align}
所以$\psi(x,t)$在$t$恒定时对$x$的偏微分为
\begin{align}
    \frac{\partial \psi}{\partial x}
    =\frac{\partial f}{\partial x}
    =\frac{\partial f}{\partial x'}\frac{\partial x'}{\partial x}
    =\frac{\partial f}{\partial x'}\, .
\end{align}
而在$x$恒定时$\psi(x,t)$对$t$的偏微分为
\begin{align}
    \frac{\partial \psi}{\partial t}
    =\frac{\partial f}{\partial t}
    =\frac{\partial f}{\partial x'}\frac{\partial x'}{\partial t}
    =\mp v\frac{\partial f}{\partial x'}
    =\mp v\frac{\partial \psi}{\partial x}\, .
\end{align}
上式表明$\psi$对$x$和$t$的变化率只差一个常系数。
继续求$\psi$的二阶偏微分有
\begin{align}
    \frac{\partial^2 \psi}{\partial x^2}
    =\frac{\partial}{\partial x}\left(\frac{\partial \psi}{\partial x}\right)
    =\frac{\partial}{\partial x}\left(\frac{\partial f}{\partial x'}\right)
    =\frac{\partial}{\partial x'}\left(\frac{\partial f}{\partial x'}\right)\frac{\partial x'}{\partial x}
    =\frac{\partial^2 f}{\partial x'^2}\, ,
\end{align}
并进一步得到
\begin{align}
    \frac{\partial^2 \psi}{\partial t^2}
    = & \frac{\partial}{\partial t}\left(\frac{\partial \psi}{\partial t}\right)
    =\frac{\partial}{\partial t}\left(\mp v\frac{\partial f}{\partial x'}\right)\nonumber    \\
    = & \mp v\frac{\partial}{\partial x'}\left(\frac{\partial f}{\partial t}\right)
    =\mp v\frac{\partial}{\partial x'}\left(\frac{\partial \psi}{\partial t}\right)\nonumber \\
    = & \mp v\frac{\partial}{\partial x'}\left(\mp v\frac{\partial f}{\partial x'}\right)
    =v^2\frac{\partial^2 f}{\partial x'^2}\nonumber                                          \\
    = & v^2\frac{\partial^2 \psi}{\partial x^2}\, .
\end{align}
整理上式即
\begin{definition}[一维\keyindex{波动微分方程}{differential wave equation}{equation\ 方程}]
    \begin{align}
        \frac{\partial^2 \psi}{\partial x^2}=\frac{1}{v^2}\frac{\partial^2 \psi}{\partial t^2}\, .
    \end{align}
\end{definition}
注意上式是一个\keyindex{齐次微分方程}{homogeneous differential equation}{equation\ 方程}，
没有仅含独立变量的项（例如一份“力”或“源”），
所以描述的是\keyindex{无阻尼系统}{undamped system}{system\ 系统}。
这意味着若$\psi$是方程的解，则它乘以任意倍数后也是解。
反之，若一个波函数是上述方程的解，则它将是$x\mp vt$的函数，
且可以对$x$和$t$求得非平凡的二阶微分。

\subsubsection*{谐波}
最简单的波形是正弦或余弦曲线。它可以称作
\keyindex{正弦波}{sinusoidal wave}{wave\ 波}、
\keyindex{简谐波}{simple harmonic wave}{wave\ 波}
或\keyindex{谐波}{harmonic wave}{wave\ 波}。
任何波形都可以由谐波叠加合成。

我们为谐波波形选定为以下简单函数：
\begin{align}
    \psi(x,t)\bigg|_{t=0}=\psi(x)=f(x)=A\sin kx\, ,
\end{align}
其中常数$k>0$称作\keyindex{传播数}{propagation number}{}，
$kx$这个整体是无量纲的。$\psi(x)$的最大值$A>0$称作波的\keyindex{振幅}{amplitude}{}。
将上式中的$x$替换为$x-vt$，改写成以速度$v$沿正$x$方向前进的波：
\begin{align}
    \psi(x,t)=A\sin k(x-vt) = f(x-vt)\, .
\end{align}
显然它是波动微分方程的一个解。该波在空间和时间中都具有周期性。
它的\keyindex{空间周期}{spatial period}{period\ 周期}
称作\keyindex{波长}{wavelength}{}，表示每个波的长度，记作$\lambda$.
当$x$大小增减$\lambda$，$\psi$应不变：
\begin{align}
    \psi(x,t)=\psi(x\pm\lambda,t)\, .
\end{align}
这对应了正弦函数自变量改变$\pm2\pi$，由于$k>0,\ \lambda>0$，所以
\begin{align}
    \lambda=\frac{2\pi}{k}\, .
\end{align}

类似地，$\psi$的\keyindex{时间周期}{temporal period}{period\ 周期}记作$\tau$，
可简称\keyindex{周期}{period}{}，即一个完整的波经过一静止观察者的时间。
它对应了波在时间上的重复行为：
\begin{align}
    \psi(x,t)=\psi(x,t\pm\tau)\, .
\end{align}
由此我们容易推出
\begin{align}
    kv\tau=2\pi\, ,
\end{align}
以及
\begin{align}
    \tau=\frac{\lambda}{v}\, .
\end{align}

周期的倒数称作\keyindex{时间频率}{temporal frequency}{frequency\ 频率}，
可简称\keyindex{频率}{frequency}{}，记作$\nu$，即单位时间里波的个数：
\begin{align}
    \nu=\frac{1}{\tau}\, ,
\end{align}
其单位为\keyindex{赫兹}{Hertz}{}（简写为Hz），即每秒周数。
结合前述定义，不难发现\keyindex{波速}{speed}{}
$v$满足\sidenote{注意$v$是英语字母，$\nu$是希腊字母。}
\begin{align}
    v=\nu\lambda\, .
\end{align}

此外我们还定义\keyindex{时间角频率}{angular temporal frequency}{frequency\ 频率}为
\begin{align}
    \omega=\frac{2\pi}{\tau}=2\pi\nu=kv\, ,
\end{align}
可简称为\keyindex{角频率}{angular frequency}{frequency\ 频率}，单位为弧度每秒（rad/s）。

此外，\keyindex{空间频率}{spatial frequency}{frequency\ 频率}，
也称\keyindex{波数}{wavenumber}{}，定义为
\begin{align}
    \kappa=\frac{1}{\lambda}\, ,
\end{align}
即单位长度中波的数目，单位为$\mathrm{m}^{-1}$.

以上所有概念也适用于非谐波，只要它是由单个剖面元规则重复构成的。

利用以上定义，我们可以写出以下常见而等价的谐波表达式：
\begin{align}
    \psi= & A\sin k(x\mp vt)\, ,                                          \\
    \psi= & A\sin (kx\mp\omega t)\, ,                                     \\
    \psi= & A\sin 2\pi\left(\frac{x}{\lambda}\mp\frac{t}{\tau}\right)\, , \\
    \psi= & A\sin 2\pi(\kappa x\mp\nu t)\, ,                              \\
    \psi= & A\sin 2\pi\nu\left(\frac{x}{v}\mp t\right)\, ,
\end{align}
其中前两个最为常用，你甚至可以改用余弦函数来表示（后文就有）。
注意到这些理想化波的$x$和$t$没有取值范围限制，
又具有单一恒定频率，所以称作是\keyindex{单色的}{monochromatic}{}
或\keyindex{单能量的}{monoenergetic}{}。
但真实的波无法无限回溯到$t=-\infty$，所以不会是严格的单色波，而是含有一个频率范围。
若这个频段很窄，则称该波是\keyindex{准单色的}{quasimonochromatic}{}。

\subsubsection*{相位与相速度}
考察任一谐波，如
\begin{align}
    \psi(x,t)= & A\sin (kx-\omega t)\, ,
\end{align}
称正弦函数的整个输入值为波的\keyindex{相位}{phase}{}，记作
\begin{align}
    \varphi=kx-\omega t\, .
\end{align}
更普遍地，对于谐波
\begin{align}
    \psi(x,t)= & A\sin (kx-\omega t+\varepsilon)\, ,
\end{align}
其相位为
\begin{align}
    \varphi=kx-\omega t+\varepsilon\, ,
\end{align}
其中$t=0$且$x=0$时的相位$\varepsilon$称作\keyindex{初相}{initial phase}{}。

根据相位定义，可知当$x$恒定时，相位对时间的变化率为
\begin{align}
    \left|\left(\frac{\partial\varphi}{\partial t}\right)_x\right|=\omega\, .
\end{align}
当$t$恒定时，相位对距离的变化率为
\begin{align}
    \left|\left(\frac{\partial\varphi}{\partial x}\right)_t\right|=k\, .
\end{align}
利用链式法则等微分知识，可推得
\begin{align}
    \left(\frac{\partial x}{\partial t}\right)_{\varphi}
    =-\displaystyle\frac{(\partial\varphi/\partial t)_x}
    {(\partial\varphi/\partial x)_t}
    =\pm\frac{\omega}{k}=\pm v\, .
\end{align}
上式最左边表示相位恒定状态的传播速度，称作波的\keyindex{相速度}{phase velocity}{}。
这里$v>0$，当波朝着正$x$方向运动时，则相速度取正号，反之则取负号。

\subsubsection*{叠加原理}
波动微分方程揭示了波一个明显区别于经典粒子流的性质：
\begin{theorem}[\keyindex{叠加原理}{superposition principle}{}]
    若$\psi_1$和$\psi_2$是同一波动方程的两个不同的解，
    则叠加它们的$\psi_1+\psi_2$也是一个解。
\end{theorem}
这意味着两个波到达同一片空间时会发生重叠，
简单地与另一方相加（相减），而不会永久瓦解其中某个波。
重叠区域内每一点的合扰动是该位置上单个成分波的代数之和。
在穿过共存区域后，每个波会继续前进离开，不受这次干扰。
注意这里我们讨论的是最为广泛的波的线性叠加，
暂不考虑极端情况下波的振幅大到以非线性方式驱动介质。

\begin{figure}[htb]
    \centering\includegraphics[width=0.9\linewidth]{Pictures/chap08/SuperpositionOfTwoSinusoids.eps}
    \caption{两个正弦波$\psi_1$和$\psi_2$的叠加，振幅分别为$A_1=1.0$和$A_2=0.9$.
        (a)$\psi_1$和$\psi_2$同相。(b)$\psi_1$领先$\psi_2$相角$\displaystyle\frac{\pi}{3}$.
        (c)$\psi_1$领先$\psi_2$相角$\displaystyle\frac{2\pi}{3}$.
        (d)$\psi_1$和$\psi_2$相位相差$\pi$，几乎要相互抵消。}
    \label{fig:08ex02.0216}
\end{figure}
\reffig{08ex02.0216}展示了两个振幅十分接近的波叠加后的结果与它们之间相位差的关系。
\reffig{08ex02.0216}(a)中两个波相位差为零，称为\keyindex{同相}{in-phase}{}。
它们互相加强，振幅增大，频率和波长不变。随着相位差增大，合成波振幅减小，
直到\reffig{08ex02.0216}(d)中相位差达到$\pi$，合成波几乎消失，
此时称两个波\keyindex{异相}{out-of-phase}{}
$180^\circ$.
异相波倾向于互相抵消的现象使得这整类现象被称作\keyindex{干涉}{interference}{}。

\subsubsection*{波的复数表示}
谐波所含的三角函数不便于数学处理，因此我们引入更方便的复数表示方法
\sidenote{本节复数等数学符号暂时遵循参考文献的记法。}。
\keyindex{复数}{complex number}{}
$\widetilde{z}$形如
\begin{align}
    \widetilde{z}=x+\mathrm{i}y=r(\cos\theta+\mathrm{i}\sin\theta)=r\mathrm{e}^{\mathrm{i}\theta}\, ,
\end{align}
其中\keyindex{虚数单位}{imaginary unit}{}
$\mathrm{i}=\sqrt{-1}$.
实数$x$和$y$分别为$\widetilde{z}$的\keyindex{实部}{real part}{complex number\ 复数}
和\keyindex{虚部}{imaginary part}{complex number\ 复数}；
实数$r\ge0$和$\theta$分别为$\widetilde{z}$的\keyindex{长度}{magnitude}{complex number\ 复数}
和\keyindex{相角}{phase angle}{complex number\ 复数}；
长度也常记作$|\widetilde{z}|$，称为复数的\keyindex{模}{modulus}{complex number\ 复数}
或\keyindex{绝对值}{absolute value}{complex number\ 复数}。

本节中，复数的\keyindex{复共轭}{complex conjugate}{}用星号表示，即
\begin{align}
    \widetilde{z}^*=(x+\mathrm{i}y)^*=x-\mathrm{i}y
    =r(\cos\theta-\mathrm{i}\sin\theta)=r\mathrm{e}^{-\mathrm{i}\theta}\, .
\end{align}
于是复数的实部和虚部可以表示为
\begin{align}
    \mathrm{Re}(\widetilde{z}) & =\frac{1}{2}(\widetilde{z}+\widetilde{z}^*)=r\cos\theta\, ,           \\
    \mathrm{Im}(\widetilde{z}) & =\frac{1}{2\mathrm{i}}(\widetilde{z}-\widetilde{z}^*)=r\sin\theta\, .
\end{align}
我们习惯上选用实部来描述谐波，即
\begin{align}
    \psi(x,t)=\mathrm{Re}[A\mathrm{e}^{\mathrm{i}(\omega t-kx+\varepsilon)}]\, ,
\end{align}
它等价于
\begin{align}
    \psi(x,t)=A\cos(\omega t-kx+\varepsilon)\, .
\end{align}
于是为了方便，在后文中我们略去实部记号把波函数简写为
\begin{align}
    \psi(x,t)=A\mathrm{e}^{\mathrm{i}(\omega t-kx+\varepsilon)}=A\mathrm{e}^{\mathrm{i}\varphi}\, ,
\end{align}
并借助复数运算法则（尤其是复指数乘除法的简便性）来进行计算，
只在要表示实际波时才取回实部。

要注意的是，波被表示为复数函数后，若参与了运算，
则只有当这些运算仅限于加减法、乘或除以一个实数，
或对一个实数变量进行微分或积分，才能恢复其实部，否则结果是错误的。

\subsubsection*{平面波}
给定时刻的光波可以用其频率、振幅、传播方向等描述，
但这并没有告诉我们光扰动在一片延伸的空间内的更多信息。
为此我们已经在定义\ref{definition:wavefront}中
引入了\keyindex{波阵面}{wavefront}{}
的概念。本节将研究理想的平面波的数学表达
\sidenote{本节向量等数学符号暂时遵循参考文献的记法。}。

\begin{figure}[htbp]
    \centering\includegraphics[width=\linewidth]{Pictures/chap08/CartesianUnitBasisVectors.eps}
    \caption{(a)直角坐标系单位基向量。(b)沿着$\vec{\mathbf{k}}$方向运动的平面波。}
    \label{fig:08ex02.0221}
\end{figure}
\keyindex{平面波}{plane wave}{wave\ 波}
是最简单的三维波了，其扰动的一切等相面构成一组平面，
且一般都垂直于传播方向。为此我们先给出平面的数学表达式：
如\reffig{08ex02.0221}(a)所示，对于直角坐标系中
的位置向量$\vec{\mathbf{r}}$，我们用三个坐标轴上的单位基向量来表示为
\begin{align}
    \vec{\mathbf{r}}=x\hat{\text{\sffamily\bfseries i}}+y\hat{\text{\sffamily\bfseries j}}+z\hat{\text{\sffamily\bfseries k}}\, .
\end{align}
它始于某个任意的原点$O$，止于点$(x,y,z)$，该点可以是空间中的任意位置。
类似地如\reffig{08ex02.0221}(b)所示，有
\begin{align}
    \vec{\mathbf{r}}-\vec{\mathbf{r}}_0
    =(x-x_0)\hat{\text{\sffamily\bfseries i}}+(y-y_0)\hat{\text{\sffamily\bfseries j}}+(z-z_0)\hat{\text{\sffamily\bfseries k}}\, .
\end{align}
我们令
\begin{align}
    (\vec{\mathbf{r}}-\vec{\mathbf{r}}_0)\cdot\vec{\mathbf{k}}=0\, ,
\end{align}
使向量$\vec{\mathbf{r}}-\vec{\mathbf{r}}_0$扫过
一垂直于$\vec{\mathbf{k}}$的平面，其端点$(x,y,z)$取一切允许的值。
设$\vec{\mathbf{k}}$为
\begin{align}
    \vec{\mathbf{k}}=k_x\hat{\text{\sffamily\bfseries i}}+k_y\hat{\text{\sffamily\bfseries j}}+k_z\hat{\text{\sffamily\bfseries k}}\, ,
\end{align}
则有
\begin{align}
    k_x(x-x_0)+k_y(y-y_0)+k_z(z-z_0)=0\, ,
\end{align}
即
\begin{align}
    k_xx+k_yy+k_zz=a\, ,
\end{align}
其中
\begin{align}
    a=k_xx_0+k_yy_0+k_zz_0=\text{常数}\, .
\end{align}
于是垂直于$\vec{\mathbf{k}}$的平面方程最简洁的表达形式为
\begin{align}
    \vec{\mathbf{k}}\cdot\vec{\mathbf{r}}=\text{常数}\, .
\end{align}
位置向量在$\vec{\mathbf{k}}$方向上的投影相同的所有点构成的轨迹即该平面。

\begin{figure}[htbp]
    \centering\includegraphics[width=0.5\linewidth]{Pictures/chap08/WavefrontsHarmonicPlaneWave.eps}
    \caption{平面简谐波的波阵面。}
    \label{fig:08ex02.0222}
\end{figure}
如\reffig{08ex02.0222}，现在我们构建一组平面，
其上的$\psi(\vec{\mathbf{r}})$于空间中正弦地变化，即
\begin{align}
    \psi(\vec{\mathbf{r}})= & A\sin(\vec{\mathbf{k}}\cdot\vec{\mathbf{r}})\, ,                  \\
    \psi(\vec{\mathbf{r}})= & A\cos(\vec{\mathbf{k}}\cdot\vec{\mathbf{r}})\, ,                  \\
    \psi(\vec{\mathbf{r}})= & A\mathrm{e}^{\mathrm{i}\vec{\mathbf{k}}\cdot\vec{\mathbf{r}}}\, .
\end{align}
显然上面三个式子中，$\psi(\vec{\mathbf{r}})$都在
由$\vec{\mathbf{k}}\cdot\vec{\mathbf{r}}$取常数定义的每个平面上保持恒定。
沿着$\vec{\mathbf{k}}$方向位移$\lambda$后，$\psi$应当在空间中重复。
注意\reffig{08ex02.0222}中只画了无数平面中的若干个，
而平面本身也应无穷延伸，因为扰动充满整个空间。
当平面波在其波阵面上任意处均有相同“强度”时，
我们称其为\keyindex{均匀波}{homogeneous wave}{wave\ 波}。

总之，$\psi$在空间中的周期性可以表示为
\begin{align}
    \psi(\vec{\mathbf{r}})=\psi\left(\vec{\mathbf{r}}+\frac{\lambda}{k}\vec{\mathbf{k}}\right)\, ,
\end{align}
这里$\vec{\mathbf{k}}$也称作\keyindex{传播向量}{propagation vector}{vector\ 向量}，
其大小$k$就是传播数\sidenote{类似地，在后文的记号中，如果我们主要想强调一个向量的大小，
则可能会记作同一字母的标量形式。读者联系上下文即可理解。}。
接着，为了使波运动起来，我们引入时间等变量，最终便得到
\begin{align}\label{eq:08ex02.DirectionCosines}
    \psi(\vec{\mathbf{r}},t)=A\mathrm{e}^{\mathrm{i}(\vec{\mathbf{k}}\cdot\vec{\mathbf{r}}\mp\omega t)}\, .
\end{align}
若$\alpha,\beta$和$\gamma$是$\vec{\mathbf{k}}$在直角坐标系下的方向余弦，则上式还可以写作
\begin{align}
    \psi(x,y,z,t)=A\mathrm{e}^{\mathrm{i}(k(\alpha x+\beta y+\gamma z)\mp\omega t)}
    =A\mathrm{e}^{\mathrm{i}k(\alpha x+\beta y+\gamma z\mp vt)}\, ,
\end{align}
注意
\begin{align}
    \alpha^2+\beta^2+\gamma^2=1\, .
\end{align}

\subsubsection*{三维波动微分方程}
像前文推导一维波动微分方程那样，我们可以
类似地用\refeq{08ex02.DirectionCosines}推导出
\begin{definition}[\keyindex{三维波动微分方程}{three-dimensional differential wave equation}{equation\ 方程}]
    \begin{align}\label{eq:08ex02.3d-differential-wave}
        \frac{\partial^2 \psi}{\partial x^2}+\frac{\partial^2 \psi}{\partial y^2}
        +\frac{\partial^2 \psi}{\partial z^2}=\frac{1}{v^2}\frac{\partial^2 \psi}{\partial t^2}\, .
    \end{align}
\end{definition}
注意上式中$x,y$和$z$是对称出现的。引入\keyindex{拉普拉斯算符}{Laplacian operator}{}
\begin{align}
    \nabla^2\equiv\frac{\partial^2}{\partial x^2}
    +\frac{\partial^2}{\partial y^2}+\frac{\partial^2}{\partial z^2}\, ,
\end{align}
则\refeq{08ex02.3d-differential-wave}简化为
\begin{align}
    \nabla^2\psi=\frac{1}{v^2}\frac{\partial^2 \psi}{\partial t^2}\, .
\end{align}
可以证明
\begin{align}
    \psi(\vec{\mathbf{r}},t)=C_1f\left(\frac{1}{k}\vec{\mathbf{k}}\cdot\vec{\mathbf{r}}-vt\right)
    +C_2g\left(\frac{1}{k}\vec{\mathbf{k}}\cdot\vec{\mathbf{r}}+vt\right)
\end{align}
均是上述波动微分方程的平面波解，其中$f$和$g$是二阶可微的任意函数
（不一定为简谐函数），$C_1$和$C_2$是常数。

\subsection{电磁理论}\label{sub:电磁理论}
在\keyindex{经典电动力学}{classical electrodynamics}{}
的图像中，电磁波是连续传递能量的。但更现代的\keyindex{量子电动力学}{quantum electrodynamics}{}
则用一种质量为零的基本“粒子”来描述电磁相互作用和能量传递，这种粒子称作\keyindex{光子}{photon}{}。
光以波的形式在空间中传播，但在发射和吸收时又显出粒子性，即二象性。
平均而言，我们可以把大量光子流的平均作用看作是经典电磁波，
但要清楚电磁波的表观连续性只是宏观世界的假象，事情并不简单。

\subsubsection*{电磁理论基本定律}
实验显示，即使是在真空中分开的\keyindex{电荷}{electric charge}{}
也仍受彼此的相互作用。我们想象每个电荷都被称作电场
的东西包围着，并假设每个电荷与它所沉浸于其中的电场直接相互作用。
\begin{definition}[\keyindex{电场}{electric field}{}]
    若一个点电荷$q$受到电场的力$\vec{\mathbf{F}}_E$，
    则它所在位置上的电场$\vec{\mathbf{E}}$就由
    \begin{align}
        \vec{\mathbf{F}}_E=q\cdot\vec{\mathbf{E}}
    \end{align}
    定义，电场强度单位为伏特/米(V/m)或牛顿/库仑(N/C)。
\end{definition}

\begin{remark}
    \keyindex{伏特}{volt}{}
    （伏）是电压和电势单位，得名于18至19世纪意大利物理学家
    亚历山德罗·朱塞佩·安东尼奥·阿纳斯塔西奥·伏特
    (Alessandro Giuseppe Antonio Anastasio Volta)；
    \keyindex{库仑}{coulomb}{}
    （库）是电荷量单位，得名于18至19世纪法国物理学家夏尔·奥古斯丁·德·库仑
    (Charles-Augustin de Coulomb)。
\end{remark}

\begin{theorem}[\keyindex{库仑定律}{Coulomb's law}{}]
    真空中两个静止点电荷之间的相互作用力，
    称作\keyindex{静电力}{electrostatic force}{}
    或\keyindex{库仑力}{Coulomb force}{}，
    其大小$F$与它们的电荷量$q_1$、$q_2$的乘积成正比，
    与它们的距离$r$的平方成反比，作用力的方向在
    它们的连线上；同性电荷相斥，异性电荷相吸。
    该定律的标量形式为
    \begin{align}
        F=k_e\frac{q_1q_2}{r^2}\,
    \end{align}
    其中比例系数$k_e$称作\keyindex{静电力常量}{electrostatic force constant}{}
    或\keyindex{库仑常量}{Coulomb's constant}{}，取值为
    \begin{align}
        k_e=\frac{1}{4\pi\epsilon_0}=8.9875517862\times10^9\text{N}\cdot \text{m}^2/\text{C}^2\, ,
    \end{align}
    其中$\epsilon_0$为真空电容率。
\end{theorem}

此外，一个运动的电荷还会受到另一个力$\vec{\mathbf{F}}_M$，
称作\keyindex{洛伦兹力}{Lorentz force}{}，
它与运动电荷的速度$\vec{\mathbf{v}}$成正比。
为此我们定义另一个场$\vec{\mathbf{B}}$：
\begin{definition}[\keyindex{磁场}{magnetic field}{}]
    它使得
    \begin{align}
        \vec{\mathbf{F}}_M=q\cdot\vec{\mathbf{v}}\times\vec{\mathbf{B}}\, .
    \end{align}
    $\vec{\mathbf{B}}$的大小称作\keyindex{磁感应}{magnetic induction}{}
    强度，单位为\keyindex{特斯拉}{tesla}{}
    (T)。
\end{definition}

\begin{remark}
    磁感应强度单位得名于19至20世纪塞尔维亚裔美国物理学家
    尼古拉·特斯拉(Nikola Tesla)。
\end{remark}

若电荷在既有电场又有磁场的空间区域内运动，
则会同时受到$\vec{\mathbf{F}}_E$和$\vec{\mathbf{F}}_M$两个力，
合力为$\vec{\mathbf{F}}=q\cdot\vec{\mathbf{E}}+q\cdot\vec{\mathbf{v}}\times\vec{\mathbf{B}}$.
后文我们将看到，随时间变化的磁场会产生电场，随时间变化的电场会产生磁场，
两者的互相依赖性是描述光的关键。

\subsubsection*{法拉第感应定律}
法拉第（迈克尔·法拉第(Michael Faraday)，18至19世纪英国物理学家）
在线圈实验中发现了\keyindex{电磁感应}{electromagnetic induction}{}
现象，而“变化”是其最实质性的因素。

\begin{figure}[htbp]
    \centering\includegraphics[width=0.4\linewidth]{Pictures/chap08/largerLoopGreaterEmf.eps}
    \caption{更大的环路通过更大的时变磁通量而产生更大的emf。}
    \label{fig:08ex02.0302}
\end{figure}
\begin{figure}[htbp]
    \centering\includegraphics[width=0.75\linewidth]{Pictures/chap08/emfProportionalPerpendicularArea.eps}
    \caption{(a)感生电动势正比于磁场垂直穿过的面积。(b)垂直于磁场的面积随$\cos\theta$变化。}
    \label{fig:08ex02.0303}
\end{figure}

将一根磁铁插进线圈时，
线圈两端会有电压，称作\keyindex{感生电动势}{induced electromotive force}{}
(emf)\sidenote{作者强调，尽管英文中感生电动势被称作“force”，
但它并不是力，而是电压，所以会尽量用简称emf来避免误解。}。
该电动势的振幅依赖于磁铁运动速度，或者说依赖于穿过线圈的$B$的变化率，而不是$B$本身。
\reffig{08ex02.0302}中，同一变化的$B$场穿过两个不同导线环路，
大的环路两端有更大的感生电动势，即它正比于$B$场垂直穿过的环路面积$A$.
而\reffig{08ex02.0303}中，当环路变倾斜，则垂直于磁场的面积$A_{\perp}$
按$A\cos\theta$变化，其中$\theta$为倾角。当$\theta=90^\circ$时，
没有$B$场穿过环路，感生电动势为零。反之，当磁场恒定时，
感生电动势正比于磁场垂直穿过环路面积的变化率，此外它还正比于$B$.

总之，当$A_{\perp}$恒定时，$\mathrm{emf}\propto A_{\perp}\displaystyle\frac{\Delta B}{\Delta t}$；
当$B$恒定时，$\mathrm{emf}\propto B\displaystyle\frac{\Delta A_{\perp}}{\Delta t}$.
因此，感生电动势依赖于$A_{\perp}$与$B$乘积的变化率。
我们定义穿过导线环路的\keyindex{磁场通量}{flux of the magnetic field}{flux\ 通量}
为
\begin{align}
    \varPhi_M=B_{\perp}A=BA_{\perp}=BA\cos\theta\, ,
\end{align}
其单位为\keyindex{韦伯}{weber}{}
(Wb)\sidenote{得名于19世纪德国物理学家威廉·爱德华·韦伯(Wilhelm Eduard Weber)。}。

\begin{figure}[htbp]
    \centering\includegraphics[width=0.5\linewidth]{Pictures/chap08/openAreaBoundedByClosedCurve.eps}
    \caption{$\vec{\mathbf{B}}$场穿过以闭合曲线$C$为边界的非闭合曲面$A$.}
    \label{fig:08ex02.0304}
\end{figure}

如\reffig{08ex02.0304}，更一般地，$\vec{\mathbf{B}}$场可能在空间中变化。
穿过导电环路包围的任意非闭合曲面$A$的磁场通量为
\begin{align}
    \varPhi_M=\iint\limits_A\vec{\mathbf{B}}\cdot\mathrm{d}\vec{\mathbf{S}}\, ,
\end{align}
其中$\mathrm{d}\vec{\mathbf{S}}$垂直于曲面朝外。环路上的感生电动势则为
\begin{align}
    \mathrm{emf}=-\frac{\mathrm{d}\varPhi_M}{\mathrm{d}t}\, ,
\end{align}
其中负号说明
\begin{theorem}[\keyindex{楞次定律}{Lenz's law}{}]
    感生电动势想要驱动的感生电流，其对应的感生磁场总是想阻碍原先引发它的磁通量的变化。
\end{theorem}

任何一个场中沿着一条闭合曲线的路径积分叫做
该场的\keyindex{环量}{circulation}{}。
电动势也是一种电势差，即单位电荷的电势能之差，
也对应着对单位电荷做的功，或者说对应着电场乘以距离。
电动势只随电场出现：
\begin{align}
    \mathrm{emf}=\oint\limits_C\vec{\mathbf{E}}\cdot\mathrm{d}\vec{\mathbf{\ell}}\, ,
\end{align}
其中积分沿着对应于环路的闭合曲线$C$进行。
联立以上三式可得
\begin{theorem}[\keyindex{法拉第电磁感应定律}{Faraday's law of electromagnetic induction}{}]
    \begin{align}
        \oint\limits_C\vec{\mathbf{E}}\cdot\mathrm{d}\vec{\mathbf{\ell}}
        =-\frac{\mathrm{d}}{\mathrm{d}t}\iint\limits_A\vec{\mathbf{B}}\cdot\mathrm{d}\vec{\mathbf{S}}\, .
    \end{align}
\end{theorem}
上式除了积分路径$C$外就别无其他物理环路了。
$C$对于是否选在导体内外或附近也没有任何要求。
该式中的电场仅由时变的磁场产生，没有电荷作为电场的\keyindex{源}{source}{}
或\keyindex{汇}{sink}{}，所以电场线均自身闭合形成环。

当我们感兴趣的是没有导线回路的空间中传播的电磁波时，
磁通量的变化是完全由$\vec{\mathbf{B}}$引起的，这时感应定律可重写为
\begin{align}
    \oint\limits_C\vec{\mathbf{E}}\cdot\mathrm{d}\vec{\mathbf{\ell}}
    =-\iint\limits_A\frac{\partial \vec{\mathbf{B}}}{\partial t}\cdot\mathrm{d}\vec{\mathbf{S}}\, .
\end{align}
上式表明一个随时间变化的磁场伴随有一个电场。

\subsubsection*{高斯定律}
电场的另一基本定律得名于18-19世纪德国数学家卡尔·弗里德里希·高斯(Carl Friedrich Gauss)。
高斯定律描述了电场通量和电荷之间的关系。
场和通量的概念都是从流体动力学引入的。
想象一个闭合曲面隔离出一团运动的流体，例如管道中充盈流动的水，
显然穿过它两个端面的体积流量大小相等，即单位时间内流进来和流出去的量相同。
此时全部表面上相加的流体净流量为零。
但如果有细针插进其中注入或吸走流体，即存在源或汇，则净流量将不为零。

这种概念同样适用于电场。如\reffig{08ex02.0307}所示，
考虑任意某电场中想象的封闭曲面$A$，则穿过$A$的
\keyindex{电场通量}{flux of the electric field}{flux\ 通量}
为
\begin{align}
    \varPhi_E=\oiint\limits_A\vec{\mathbf{E}}\cdot\mathrm{d}\vec{\mathbf{S}}\, ,
\end{align}
其中带圈的二重积分号强调积分曲面是封闭的，$\mathrm{d}\vec{\mathbf{S}}$垂直于曲面朝外。
当封闭曲面包围的区域内没有电场的源或汇时，电场通量等于零。
\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.5\linewidth]{Pictures/chap08/GausssLawElectric.eps}
    \caption{穿过封闭区域$A$的电场$\vec{\mathbf{E}}$.}
    \label{fig:08ex02.0307}
\end{figure}

当区域内存在源或汇时，考虑任意以正电荷$q$为球心、半径为$r$的球面。
根据库仑定律，该正电荷的电场$\vec{\mathbf{E}}$在球面表面任意处的大小均为
\begin{align}
    E=\frac{1}{4\pi\epsilon_0}\frac{q}{r^2}\, ,
\end{align}
且都沿径向向外垂直于球面表面，即$\vec{\mathbf{E}}=\vec{\mathbf{E}}_\perp$.
于是
\begin{align}
    \varPhi_E=\oiint\limits_A\vec{\mathbf{E}}\cdot\mathrm{d}\vec{\mathbf{S}}
    =\oiint\limits_A E_\perp\mathrm{d}S
    =E\oiint\limits_A\mathrm{d}S=4\pi r^2E=\frac{q}{\epsilon_0}\, .
\end{align}
推广到区域内的多个电荷时，将上式累加即可：
\begin{align}
    \varPhi_E=\frac{1}{\epsilon_0}\sum q\, .
\end{align}
把电荷分布近似为连续分布，在$A$所包围的体积$V$内，
记电荷分布密度为$\rho$，则我们最终得到
\begin{theorem}[电场的\keyindex{高斯定律}{Gauss's Law}{}]
    穿过任意封闭曲面的净电场通量正比于它包围的净电荷量。
    \begin{align}\label{eq:08ex02.GausssLawElectric}
        \oiint\limits_A\vec{\mathbf{E}}\cdot\mathrm{d}\vec{\mathbf{S}}
        =\frac{1}{\epsilon_0}\iiint_V\rho\mathrm{d}V\, .
    \end{align}
\end{theorem}

真空中，自由空间的电容率为$\epsilon_0=8.85418782\times10^{-12}\text{C}^2/\text{N}\cdot\text{m}^2$，
这个值取决于其定义和相关物理量的单位选择，并不反映真空的本质属性。
若电荷嵌在某种实物介质中，则须用该介质的
电容率$\epsilon$替代\refeq{08ex02.GausssLawElectric}中的$\epsilon_0$；
然而电容率又是描述平行板电容器的的基础概念，单位制的差异
引发了$\epsilon$的取值问题。为了避免这些麻烦，
我们定义一个与单位制无关的新物理量，即\keyindex{相对电容率}{relative permittivity}{permittivity\ 电容率}
$K_E$，旧称\keyindex{相对介电常数}{relative dielectric constant}{}：
\begin{align}
    K_E=\frac{\epsilon}{\epsilon_0}\, ,
\end{align}
显然真空的$K_E$为1，它是无量纲的。

目前物理界尚未发现与电荷对应的“磁荷”存在，没有发现过孤立的磁极（磁单极）。
磁场$\vec{\mathbf{B}}$的磁力线总是连续和闭合的。因此对于磁场中的任何封闭曲面，
由于其中不存在任何磁单极，所以进入和离开的磁力线数目保持相等（如\reffig{08ex02.0308}），
穿过该曲面的磁通量$\varPhi_M$为零。于是我们得到
\begin{theorem}[磁场的高斯定律]
    磁场中的任何封闭曲面的净磁通量为零。
    \begin{align}
        \oiint\limits_A\vec{\mathbf{B}}\cdot\mathrm{d}\vec{\mathbf{S}}=0\, .
    \end{align}
\end{theorem}
\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.5\linewidth]{Pictures/chap08/GausssLawMagnetic.eps}
    \caption{穿过封闭区域$A$的磁场$\vec{\mathbf{B}}$.}
    \label{fig:08ex02.0308}
\end{figure}

\subsubsection*{安培环路定律}
