\section{译者补充：几何光学}\label{sec:译者补充：几何光学}

\begin{remark}
    本节内容不是原书内容，而是译者根据《Optics》\citep{hecht2016optics}
    补充的，请酌情参考和斧正。然而本节仍需要读者对光与波的基本物理概念有所了解，
    这些内容一般可在中学和大学物理教材中找到。
\end{remark}

\subsection{光学背景知识}\label{sub:光学背景知识}
光是人眼可见频段的电磁波，可在真空与介质中传播。
光在真空中的传播速度最大，在介质中的传播速度与介质类型有关。
\begin{definition}
    三维中的\keyindex{波阵面}{wavefront}{}是某一时刻波\keyindex{相位}{phase}{}相同的点构成的面。
\end{definition}
\begin{definition}
    电磁波在真空中的传播速率$c$与在介质中的传播速率$v$的比值
    定义为\keyindex{绝对折射率}{absolute index of refraction}{index of refraction\ 折射率}，
    可简称折射率：
    \begin{align}
        n=\frac{c}{v}\, .
    \end{align}
\end{definition}
\begin{corollary}
    任意介质的绝对折射率都大于1.
\end{corollary}

光传播时在两种介质交界面上会发生\keyindex{反射}{reflection}{}
和\keyindex{折射}{refraction}{}，如\reffig{6.26}所示：
其中上层与下层介质的绝对折射率分别为$n_i$和$n_t (n_i<n_t)$；
入射光线、反射光线、折射光线与界面法线的夹角$\theta_i, \theta_r, \theta_t$分别称为
\keyindex{入射角}{angle of incidence}{}、
\keyindex{反射角}{angle of reflection}{}、
\keyindex{折射角}{angle of refraction}{}。
入射光线和界面法线确定的平面称为\keyindex{入射平面}{plane of incidence}{}。
\begin{figure}[htbp]
    \centering\includegraphics[width=0.5\linewidth]{chap06/ReflectionAndRefraction.eps}
    \caption{反射与折射分别遵循反射定律和折射定律。}
    \label{fig:6.26}
\end{figure}

\begin{proposition}\label{theorem:0607-LawOfReflection}
    \keyindex{反射定律}{law of reflection}{}：反射光线在入射平面内；
    反射光线和入射光线分居界面法线两侧；反射角等于入射角，即
    \begin{align}
        \theta_r=\theta_i \, .
    \end{align}
\end{proposition}
\begin{proposition}\label{theorem:0607-LawOfRefraction}
    \keyindex{折射定律}{law of refraction}{}：折射光线在入射平面内；
    折射光线和入射光线分居界面法线两侧；折射角与入射角遵循\keyindex{斯涅尔定律}{Snell's law}{}，即
    \begin{align}
        n_i\sin\theta_i=n_t\sin\theta_t \, .
    \end{align}
\end{proposition}
\begin{corollary}
    光线进入更大折射率的介质时会更偏向界面法线，
    进入更小折射率介质时则会更偏离法线。
\end{corollary}
\begin{definition}
    两种介质的绝对折射率之比定义为\keyindex{相对折射率}{relative index of refraction}{index of refraction\ 折射率}：
    \begin{align}
        n_{ti}=\frac{n_t}{n_i}\, .
    \end{align}
    由此斯涅尔定律也可写作：
    \begin{align}
        \frac{\sin\theta_i}{\sin\theta_t}=n_{ti}\, .
    \end{align}
\end{definition}

我们考虑\reffig{6.27}的情景：一束光线从点$S$起依次穿过$m$层介质并发生折射，
最终到达点$P$.设在每种介质中传播时对应的介质绝对折射率、路程、传播速度
分别为$n_j, s_j, v_j (j=1,\ldots,m)$.于是光线传播的总时间为
\begin{align}
    t=\sum\limits_{j=1}^{m}{\frac{s_j}{v_j}}\, ,
\end{align}
利用绝对折射率的定义可得
\begin{align}
    t=\frac{1}{c}\sum\limits_{j=1}^{m}{n_js_j}\, .
\end{align}
相对于空间路程$\sum\limits_{j=1}^{m}{s_j}$，
我们定义上式中的$\sum\limits_{j=1}^{m}{n_js_j}$
为\keyindex{光程长度}{optical path length}{}(OPL)。
更一般地，在非均匀介质中折射率是位置的函数，因此有
\begin{align}
    OPL=\int_S^P {n(s)\mathrm{d}s}\, .
\end{align}
\begin{figure}[htbp]
    \centering\includegraphics[width=0.5\linewidth]{chap06/PropagatingThroughLayeredMaterial.eps}
    \caption{在多层介质中传播的光线。}
    \label{fig:6.27}
\end{figure}

事实上，包括反射与折射在内，光的一般传播规律遵循费马原理。
它可推导出光线在真空中沿直线传播的性质以及反射定律和折射定律。
\begin{proposition}
    \keyindex{费马原理}{Fermat's principle}{}的现代形式是：
    光线从点$S$到点$P$所走路径的光程长度相对于该路径的变化一定是\keyindex{平稳}{stationary}{}的。
\end{proposition}

\begin{figure}[htbp]
    \centering\includegraphics[width=0.5\linewidth]{chap06/FermatsPrincipleAppliedToRefraction.eps}
    \caption{费马原理运用于折射。}
    \label{fig:6.28}
\end{figure}

如\reffig{6.28}所示，我们利用费马原理来推导斯涅尔定律：
\begin{prove}\label{prove:FermatSnell}
    考虑从点$S$到点$P$的光线，它在界面上点$O$处发生折射，
    相应量已标在图中。其光程长度为
    \begin{align}
        OPL=n_i\overline{SO}+n_t\overline{OP}=n_i\sqrt{x^2+h^2}+n_t\sqrt{b^2+(a-x)^2}\, .
    \end{align}

    依据费马原理，我们令$\displaystyle\frac{\mathrm{d}OPL}{\mathrm{d}x}=0$，可得
    \begin{align}
        \frac{n_ix}{\sqrt{x^2+h^2}}-\frac{n_t(a-x)}{\sqrt{b^2+(a-x)^2}}=0\, .
    \end{align}
    注意到$\displaystyle\sin\theta_i=\frac{x}{\sqrt{x^2+h^2}}$以及
    $\displaystyle\sin\theta_t=\frac{(a-x)}{\sqrt{b^2+(a-x)^2}}$，带入得
    \begin{align}
        n_i\sin\theta_i=n_t\sin\theta_t\, .
    \end{align}
    即得到斯涅尔定律。
\end{prove}

\begin{figure}[htbp]
    \centering
    \subfloat[日常的反射光可视作由无数原子级散射复合而成，例如这张人脸。]
    {\includegraphics[width=0.25\linewidth]{chap06/PersonFace.eps}\label{fig:6.29.1}}\,
    \subfloat[光学系统的共轭点]{\includegraphics[width=0.7\linewidth]{chap06/ConjugateFoci.eps}\label{fig:6.29.2}}
    \caption{光的发散与会聚。}
    \label{fig:6.29}
\end{figure}

如\reffig{6.29.1}，自身发光或被照亮的物体可以视作是大量辐射点\keyindex{源}{source}{}构成的。
每个点源都在发出\keyindex{球面波}{spherical wave}{}。
此时我们说光线从给定点源\keyindex{发散}{diverge}{}。
反之，若球面波坍缩到一点，我们说光线\keyindex{会聚}{converge}{}到该点。
实际中我们往往只处理\keyindex{波阵面}{wavefront}{}的一部分。
在\keyindex{几何光学}{geometrical optics}{optics\ 光学}中，
我们研究如何通过插入反射和折射体来控制改变波阵面（光线）并忽略所有衍射效应。
如\reffig{6.29.2}所示，当点$S$发散的一部分波阵面经过\keyindex{光学系统}{optical system}{}后
会聚到点$P$时，依据光路可逆性原理，在点$P$处发散的波阵面可以反向经过该系统处理后会聚到点$S$.
我们称点$S$和点$P$互为\keyindex{共轭点}{conjugate point}{}。
对于理想光学系统，三维空间中的任意区域都会完美成像为另一区域，
前者称为\keyindex{物空间}{object space}{}，后者称为\keyindex{像空间}{image space}{}。

\subsection{透镜}\label{sub:透镜}
\begin{definition}
    \keyindex{透镜}{lens}{}是重新配置能量传播分布的折射器件，
    即意味着现有介质的不连续性。
\end{definition}

如\reffig{6.30}，最常见的是中间厚边缘薄的\keyindex{凸透镜}{convex lens}{lens\ 透镜}，
也称\keyindex{会聚透镜}{converging lens}{lens\ 透镜}、\keyindex{正透镜}{positive lens}{lens\ 透镜}，
以及中间薄边缘厚的\keyindex{凹透镜}{concave lens}{lens\ 透镜}，
也称\keyindex{发散透镜}{diverging lens}{lens\ 透镜}、\keyindex{负透镜}{negative lens}{lens\ 透镜}。
当一束平行光穿过凸透镜（或凹透镜）时，
光线会聚的点（或从之发散的点）称为透镜的一个\keyindex{焦点}{focal point}{}。
对于\reffig{6.30}(b)，将点源置于透镜前方光轴上的$F_1$处，光线会聚到共轭点$F_2$.
此时若在$F_2$处放置一个光屏，则屏上会有相应发亮的像，称该像是\keyindex{实}{real}{}的。
对于\reffig{6.30}(c)，将点源置于透镜前方无穷远处，从透镜射出的光是发散的，
且看起来好像是从点$F_2$发散。但在该位置的光屏上不会出现发亮的像，所以称该像是\keyindex{虚}{virtual}{}的。
\begin{figure}[htbp]
    \centering\includegraphics[width=0.8\linewidth]{chap06/HyperbolicLenses.eps}
    \caption{几种双曲面透镜横截面。其中(a)和(b)是凸透镜，(c)是凹透镜。}
    \label{fig:6.30}
\end{figure}

\subsubsection{球面透镜的折射}
现实生活中绝大多数透镜的表面是一片球面，因为它的制造难度比非球面透镜低得多。
尽管这种透镜会有\keyindex{像差}{aberration}{}，但现代制造技术可以把它控制在极小范围内。
以下我们将探讨球面透镜的成像规律，并约定后文中的透镜都是关于光轴旋转对称的。
\begin{figure}[htbp]
    \centering
    \subfloat[球形界面上的折射。]{\includegraphics[width=0.48\linewidth]{chap06/RefractionSphericalInterface.eps}\label{fig:6.31.1}}\,
    \subfloat[球形界面上相同入射角的光线。]{\includegraphics[width=0.5\linewidth]{chap06/IncidentSameAngle.eps}\label{fig:6.31.2}}
    \caption{球面透镜的折射。}
    \label{fig:6.31}
\end{figure}

\reffig{6.31}展示了位于点$S$处的点源发出的波遇到
以点$C$为中心且半径为$R$的球面透镜界面后的折射情况。
外部介质和透镜的折射率分别为$n_1$和$n_2 (n_1<n_2)$.
点$V$称为界面的\keyindex{顶点}{vertex}{}。
长度$s_o=\overline{SV}$称为\keyindex{物距}{object distance}{}。
光线$\overline{SA}$在界面上点$A$发生折射后偏向局部法线，也偏向了光轴，
设于光轴交于点$P$，入射角为$\theta_i$，折射角为$\theta_t$.
注意最终过点$P$的折射光线都有相同的入射角（\reffig{6.31.2}）。
长度$s_i=\overline{VP}$称为\keyindex{像距}{image distance}{}。
连线$\overline{CA}$与光轴的夹角为$\varphi$，并记
长度$\mathcal{l}_o=\overline{SA}, \mathcal{l}_i=\overline{AP}$.
因此光线从点$S$经$A$到$P$的光程长度为
\begin{align}
    OPL=n_1\mathcal{l}_o+n_2\mathcal{l}_i\, ,
\end{align}
其中$\mathcal{l}_o$和$\mathcal{l}_i$可分别在$\triangle SAC$和$\triangle ACP$中应用余弦定理得到：
\begin{align}
    \mathcal{l}_o & =\sqrt{R^2+(s_o+R)^2-2R(s_o+R)\cos\varphi}\, ,       \\
    \mathcal{l}_i & =\sqrt{R^2+(s_i-R)^2-2R(s_i-R)\cos(\pi-\varphi)}\, .
\end{align}

考虑到点$A$的位置由$\varphi$完全决定，而$n_1, n_2, s_o, s_i, R$等量是定值，
所以光程长度是关于$\varphi$的函数。
依据费马原理，令光程长度对$\varphi$的导数为零，得到
\begin{align}
    \frac{n_1R(s_o+R)\sin\varphi}{\mathcal{l}_o}-\frac{n_2R(s_i-R)\sin\varphi}{\mathcal{l}_i}=0\, ,
\end{align}
整理后为
\begin{align}
    \frac{n_1}{\mathcal{l}_o}+\frac{n_2}{\mathcal{l}_i}=\frac{1}{R}\left(\frac{n_2s_i}{\mathcal{l}_i}-\frac{n_1s_o}{\mathcal{l}_o}\right)\, .
\end{align}

也就是说，从点$S$到点$P$的折射光线必定遵循上述数量规律。
事实上该规律不要求$s_o$等量必须为正数。具体来说：
\begin{itemize}
    \item 当点$S$在点$V$左边时，$s_o$取正，反之取负；
    \item 当点$P$在点$V$右边时，$s_i$取正，反之取负；
    \item 当点$C$在点$V$右边时，$R$取正，反之取负。
\end{itemize}

按照这样的约定确定符号时，该规律对球面凹透镜同样适用。
然而它形式仍较复杂，我们考虑进一步化简它：当$\varphi$非常接近0时，点$A$十分接近点$V$，
且此时运用一级近似$\sin\varphi\approx\varphi$和$\cos\varphi\approx 1$易
知$\mathcal{l}_o\approx s_o, \mathcal{l}_i\approx s_i$，此时近似有
\begin{align}\label{eq:6.24}
    \frac{n_1}{s_o}+\frac{n_2}{s_i}=\frac{n_2-n_1}{R}\, ,
\end{align}

我们称这样与光轴所成角度很小的光线为\keyindex{傍轴光线}{paraxial ray}{ray\ 光线}。
注意\refeq{6.24}在关于光轴对称的很小一片区域上与点$A$的位置无关，
我们称该区域为\keyindex{傍轴区域}{paraxial region}{}。
1841年，高斯在上述近似下系统阐述了成像规律，因此也称该结论为
一阶、傍轴或\keyindex{高斯光学}{Gaussian optics}{optics\ 光学}。

如\reffig{6.32.1}，当光轴上点$F_o$的像在无穷远时，$s_i=\infty$，此时的物距$s_o$称为
\keyindex{第一焦距}{first focal length}{focal length\ 焦距}或
\keyindex{物方焦距}{object focal length}{focal length\ 焦距}$f_o$，即
\begin{align}
    f_o=\frac{n_1}{n_2-n_1}R\, .
\end{align}
点$F_o$称为\keyindex{第一焦点}{first focus}{focus\ 焦点}或\keyindex{物方焦点}{object focus}{focus\ 焦点}。
当$f_o>0$时，焦点$F_o$在顶点$V$左侧，反之在右侧。
类似地如\reffig{6.32.2}，当$s_o=\infty$时，光轴上对应成像的点$F_i$
称为\keyindex{第二焦点}{second focus}{focus\ 焦点}或\keyindex{像方焦点}{image focus}{focus\ 焦点}。
此时的像距$s_i$称为\keyindex{第二焦距}{second focal length}{focal length\ 焦距}或\keyindex{像方焦距}{image focal length}{focal length\ 焦距}，即
\begin{align}
    f_i=\frac{n_2}{n_2-n_1}R\, .
\end{align}
且当$f_i>0$时，焦点$F_i$在顶点$V$右侧，反之在左侧。
\begin{figure}[htbp]
    \centering
    \subfloat[物方焦点与物方焦距]{\includegraphics[scale=1.25]{chap06/ObjectFocus.eps}\label{fig:6.32.1}}\,\,
    \subfloat[像方焦点与像方焦距]{\includegraphics[scale=1.25]{chap06/ImageFocus.eps}\label{fig:6.32.2}}
    \caption{球面透镜的焦距与焦点}
    \label{fig:6.32}
\end{figure}

之前我们说过，当出射光线是发散时我们称该像是虚的（\reffig{6.33.1}），
此时$s_i<0$，像点$F_i$在顶点$V$的左边；类似地，当入射光线是会聚时我们称物是虚的
（\reffig{6.33.2}），此时$s_o<0$，物点$F_o$在顶点$V$右边。
\begin{figure}[htbp]
    \centering
    \subfloat[虚像点]{\vspace{-5cm}\includegraphics[scale=1]{chap06/VirtualImagePoint.eps}\label{fig:6.33.1}}\,\,\,
    \subfloat[虚物点]{\includegraphics[scale=1]{chap06/VirtualObjectPoint.eps}\label{fig:6.33.2}}
    \caption{虚像点和虚物点}
    \label{fig:6.33}
\end{figure}

\subsubsection{薄透镜}
只有一个元件（即两个折射界面）的称为\keyindex{简单透镜}{simple lens}{lens\ 透镜}，
多于一个元件的称为\keyindex{复合透镜}{compound lens}{lens\ 透镜}。
此外按照透镜厚度能否忽略还可以分为\keyindex{薄透镜}{thin lens}{lens\ 透镜}和\keyindex{厚透镜}{thick lens}{lens\ 透镜}。
以下我们讨论简单薄透镜的成像规律。
\begin{figure}[htbp]
    \centering\includegraphics[width=0.75\linewidth]{chap06/SphericalLens.eps}
    \caption{球面透镜的成像规律}
    \label{fig:6.34}
\end{figure}

\reffig{6.34}展示了两个界面都是球面的透镜是如何折射光线的。
这里外部介质折射率为$n_m$，透镜折射率为$n_l, (n_l>n_m)$，
左边（第一）界面的球心为$C_1$，半径为$R_1>0$，顶点为$V_1$；
右边（第二）界面的球心为$C_2$，半径为$R_2<0$，顶点为$V_2$.
两个顶点距离为$d$.在傍轴近似下，光轴上的点源$S$发出的光线经过
第一界面折射后的像点为$P'$，对应有物距$s_{o1}=\overline{SV_1}>0$，
像距$s_{i1}=\overline{V_1P'}<0$；
同时$P'$也是第二次折射的物点，折射后为光轴上的像点$P$，
并有物距$s_{o2}=\overline{P'V_2}>0$，像距$s_{i2}=\overline{V_2P}>0$.
根据\refeq{6.24}的结论，两次折射分别满足：
\begin{align}
    \frac{n_m}{s_{o1}}+\frac{n_l}{s_{i1}} & =\frac{n_l-n_m}{R_1}\, , \\
    \frac{n_l}{s_{o2}}+\frac{n_m}{s_{i2}} & =\frac{n_m-n_l}{R_2}\, .
\end{align}
考虑到$|s_{o2}|=|s_{i1}|+d$，结合各量正负性带入上式整理得
\begin{align}
    \frac{n_m}{s_{o1}}+\frac{n_m}{s_{i2}}=(n_l-n_m)\left(\frac{1}{R_1}-\frac{1}{R_2}\right)+\frac{n_ld}{(s_{i1}-d)s_{i1}}\, .
\end{align}
注意到对于整个透镜而言，其物距为$s_o=s_{o1}$，像距为$s_i=s_{i2}$.
当透镜很薄时，$d\approx 0$，点$V_1$和$V_2$十分靠近，所以上式右边最后一项可以舍去。
同时假设外部介质是空气，即$n_m\approx 1$，
于是我们得到：
\begin{proposition}
    \keyindex{薄透镜方程}{thin-lens equation}{}，也称\keyindex{透镜制造者公式}{Lensmaker's Formula}{}：
    \begin{align}
        \frac{1}{s_o}+\frac{1}{s_i}=(n_l-1)\left(\frac{1}{R_1}-\frac{1}{R_2}\right)\, .
    \end{align}
\end{proposition}

事实上该结论对各量取正负的情况都成立。分别令物距和像距取无穷远，
可以得到透镜对应的像方焦距$f_i=\lim\limits_{s_o\to\infty}s_i$
和物方焦距$f_o=\lim\limits_{s_i\to\infty}s_o$.
显然$f_i=f_o$，我们去掉下标把焦距记为$f$，则有
\begin{align}
    \frac{1}{f}=(n_l-1)\left(\frac{1}{R_1}-\frac{1}{R_2}\right)\, .
\end{align}
由此得到
\begin{proposition}
    \keyindex{高斯透镜公式}{Gaussian lens formula}{}：
    \begin{align}
        \frac{1}{s_o}+\frac{1}{s_i}=\frac{1}{f}\, .
    \end{align}
\end{proposition}

\begin{figure}[htbp]
    \centering\includegraphics[width=0.75\linewidth]{chap06/OpticalCenter.eps}
    \caption{球面透镜的光心}
    \label{fig:6.35}
\end{figure}

对于球面透镜而言，过光心的光线不改变传播方向。
如\reffig{6.35}所示，我们取一对平行平面分别与两界面相切于点$A$和点$B$.
分别过点$A$和点$B$作平面的垂线，由于这是球面透镜，它们必和光轴交于
对应球心$C_1$和$C_2$，于是$AC_1$平行于$BC_2$，且易知$A, B, C_1, C_2$四点共面。
设$AB$与$C_1C_2$交于点$O$，则有$\triangle AOC_1\sim\triangle BOC_2$，于是
\begin{align}
    \frac{|R_1|}{|R_2|}=\frac{\overline{OC_1}}{\overline{OC_2}}\, .
\end{align}
考虑到$R_1, R_2, \overline{C_1C_2}$均为定值，所以$O$是定点。
又因为$\angle OAC_1=\angle OBC_2$，所以第一界面的折射角等于第二界面的入射角，
两次折射介质相反，所以第一界面的入射角等于第二界面的折射角，即入射光线与最终出射光线同向。
也就是说，当且仅当光线经过球面透镜的定点$O$时不改变方向，称定点$O$为透镜的\keyindex{光心}{optical center}{}。
此时光线的横向偏移量正比于透镜厚度。对于薄透镜而言，我们可以近似地把整条过光心的光线视作直线。

我们已经知道平行傍轴光线会被球形界面聚焦到一点。
因此如\reffig{6.36}所示，若干束与光轴倾角很小、范围很小、且垂直于界面入射的光线
对应的焦点将分布在球面$\sigma$上，其球心即界面的球心$C$.
在光线范围很小的情况下，我们可把$\sigma$视作与透镜光轴垂直的平面，
称之为\keyindex{焦平面}{focal plane}{}。
如\reffig{6.37}，在傍轴假设下，所有平行光束都会被球面透镜聚焦
到\keyindex{第二焦平面}{second focal plane}{focal plane\ 焦平面}上，
也称\keyindex{后焦平面}{back focal plane}{focal plane\ 焦平面}。
类似地还有与物方焦点对应的\keyindex{第一焦平面}{first focal plane}{focal plane\ 焦平面}，
也称\keyindex{前焦平面}{front focal plane}{focal plane\ 焦平面}。
\begin{figure}[htbp]
    \centering\includegraphics[width=0.75\linewidth]{chap06/FocusingSeveralRayBundles.eps}
    \caption{几束窄范围平行光的聚焦。}
    \label{fig:6.36}
\end{figure}
\begin{figure}[htbp]
    \centering\includegraphics[width=0.75\linewidth]{chap06/FocalPlane.eps}
    \caption{透镜的焦平面。}
    \label{fig:6.37}
\end{figure}

对于透镜有三种特殊光线（包括延长线）帮助我们确定成像情况。
如\reffig{6.38}所示，它们分别是过光心而不改变方向的光线1、
平行于光轴入射而过焦点的光线2、过焦点入射而平行于光轴出射的光线3.
出射光线的交点即定出成像的位置、大小、倒立情况。
\begin{figure}[htbp]
    \centering\includegraphics[width=\linewidth]{chap06/RealObjectAndPositiveLensAndNegativeLens.eps}
    \caption{利用三种特殊光线确定凸透镜和凹透镜对实物的成像。}
    \label{fig:6.38}
\end{figure}

我们接下来讨论薄透镜的具体成像规律。如\reffig{6.39}所示，
以焦距为$f$的凸透镜为例。分别记物和像偏移光轴的横向
\sidenote{横向指垂直于光轴的方向，下同。}距离为$y_o, y_i$，
在轴上方取正，下方取负。所以这里图中有$y_o>0, y_i<0$.
当$y_o$与$y_i$异号时，我们说像是\keyindex{倒}{inverted}{}的，
反之则是\keyindex{正}{erect}{}的。
记物到物方焦点$F_o$的轴向距离为$x_o=\overline{S_1F_o}=s_o-f$，
当$S_1$在$F_o$左边时$x_o$取正，反之取负；
记像到像方焦点$F_i$的轴向距离为$x_i=\overline{F_iP_1}=s_i-f$，
当$P_1$在$F_i$右边时$x_i$取正，反之取负。
\begin{figure}[htbp]
    \centering\includegraphics[width=0.75\linewidth]{chap06/ObjectAndImageLocation.eps}
    \caption{薄透镜成像时物和像的位置。}
    \label{fig:6.39}
\end{figure}

因为易知$\triangle AF_iO\sim\triangle P_2F_iP_1$，所以有
\begin{align}
    \frac{y_o}{|y_i|}=\frac{f}{x_i}\, .
\end{align}
类似地，因为$\triangle S_1F_oS_2\sim\triangle OF_oB$，所以有
\begin{align}
    \frac{y_o}{|y_i|}=\frac{x_o}{f}\, .
\end{align}
结合上面两式得到
\begin{proposition}
    薄透镜方程的\keyindex{牛顿形式}{Newtonian form}{}：
    \begin{align}
        x_ox_i=f^2\, .
    \end{align}
\end{proposition}
1704年牛顿首次在他的《Opticks》一书中阐述了该规律。
上式还说明，$x_o$与$x_i$一定同号，因此有
\begin{corollary}
    薄透镜的物和像一定在各自相应焦点的对侧。
\end{corollary}

\begin{definition}
    光学系统最终成像的横向维度与物的对应维度之比
    称为\keyindex{横向放大率}{transverse magnification}{}，记作
    \begin{align}
        M_T=\frac{y_i}{y_o}\, .
    \end{align}
\end{definition}
不难发现，横向放大率还满足
\begin{align}
    M_T=-\frac{s_i}{s_o}=-\frac{x_i}{f}=-\frac{f}{x_o}\, .
\end{align}

\begin{corollary}
    $M_T>0$对应正像，$M_T<0$对应倒像。
\end{corollary}
\begin{corollary}
    单个薄透镜元件所成实像必是倒像。
\end{corollary}

\reftab{6.2}列出了薄透镜成像的规律，其中凸透镜部分与\reffig{6.40}对应。
\begin{table}[htbp]
    \centering
    \begin{tabular}{c|c|cccc}
        \toprule
        \multirow{2}{*}{\textbf{透镜类型}} & \multirow{2}{*}{\textbf{实物位置}} & \multicolumn{4}{c}{\textbf{像}}                                                                \\
        \cline{3-6}
                                           &                                    & \textbf{类型}                   & \textbf{位置}            & \textbf{朝向} & \textbf{相对大小} \\
        \midrule
        \multirow{5}{*}{凸透镜}            & $\infty>s_o>2f$                    & 实                              & $f<s_i<2f$               & 倒            & 缩小              \\
                                           & $s_o=2f$                           & 实                              & $s_i=2f$                 & 倒            & 相等              \\
                                           & $f<s_o<2f$                         & 实                              & $\infty>s_i>2f$          & 倒            & 放大              \\
                                           & $s_o=f$                            & -                               & $\pm\infty$              & -             & -                 \\
                                           & $s_o<f$                            & 虚                              & $|s_i|>s_o$              & 正            & 放大              \\
        \midrule
        凹透镜                             & 任意                               & 虚                              & $|s_i|<|f|$且$|s_i|<s_o$ & 正            & 缩小              \\
        \bottomrule
    \end{tabular}
    \caption{薄透镜对实物的成像。}
    \label{tab:6.2}
\end{table}

\begin{figure}
    \centering\includegraphics[width=0.75\linewidth]{chap06/ImageFormingBehavior.eps}
    \caption{薄凸透镜成像规律。}
    \label{fig:6.40}
\end{figure}

\begin{definition}
    光学系统轴向上像的变化量与物的变化量之比称为\keyindex{纵向放大率}{longitudinal magnification}{}，即
    \begin{align}
        M_L=\frac{\mathrm{d}x_i}{\mathrm{d}x_o}\, .
    \end{align}
\end{definition}
根据薄透镜方程的牛顿形式可得
\begin{corollary}
    对于单种介质中焦距为$f$的薄透镜，其纵向放大率$M_L$与横向放大率$M_T$满足：
    \begin{align}
        M_L=-\frac{f^2}{x_o^2}=-M_T^2\, .
    \end{align}
\end{corollary}
显然恒有$M_L<0$，即指向透镜的方向会被成像为背对透镜的方向（\reffig{6.41}）。
\begin{figure}[htbp]
    \centering\includegraphics[width=0.5\linewidth]{chap06/ImageOrientation.eps}
    \caption{薄透镜成像朝向。}
    \label{fig:6.41}
\end{figure}

还有一种特殊的成像情况：
即入射光线（的延长线）会聚在透镜右侧，即物是虚的，$s_o<0$.
这种情况在复合透镜中十分常见。
\reffig{6.42}依次展示了虚物所成的正实像、倒虚像、放大正实像。
\begin{corollary}
    当物和像在透镜同侧时，两者必然是一实一虚的。
\end{corollary}
\begin{figure}[htbp]
    \centering
    \subfloat[虚物和正实像。]{\includegraphics[scale=1]{chap06/VirtualObjectAndRealUprightImage.eps}\label{fig:6.42.1}}\,
    \subfloat[虚物和倒虚像。]{\includegraphics[scale=1]{chap06/VirtualObjectAndVirtualInvertedImage.eps}\label{fig:6.42.2}}\\
    \subfloat[虚物和放大的正实像。]{\includegraphics[scale=1]{chap06/VirtualObjectAndRealEnlargedUprightImage.eps}\label{fig:6.42.3}}
    \caption{薄透镜的虚物成像。}
    \label{fig:6.42}
\end{figure}

\reffig{6.43}给出了利用焦平面来追踪光线折射方向的方法。
我们已经知道平行入射薄透镜的光线会交于焦平面上一点，反之亦然。
对于与焦平面交于点$A$的入射光线$AB$，我们作过光心的光线$AO$，则出射光线应平行于$AO$.
\begin{figure}[htbp]
    \centering\includegraphics[width=\linewidth]{chap06/FocalPlaneRayTracing.eps}
    \caption{焦平面光线追踪。}
    \label{fig:6.43}
\end{figure}

\reffig{6.44}展示了利用该方法在三个同轴薄透镜$L_1,L_2,L_3$中追踪光线的情况。
其中标出了$L_1$和$L_3$的第一焦平面和$L_2$的第二焦平面。
入射光线$A_1B_1$与$L_1$第一焦平面交于$A_1$，作过$L_1$光心$O_1$的光线$A_1O_1$，
再过点$B_1$作其平行线得到出射光线$B_1B_2$，并与$L_2$的第二焦平面交于$A_2$.
作过$L_2$光心$O_2$的光线$O_2A_2$，再过点$B_2$作其平行线得到出射光线$B_2B_3$，
并与$L_3$的第一焦平面交于点$A_3$.作过$L_3$光心$O_3$的光线$A_3O_3$，
再过点$B_3$作其平行线，得到最终出射光线。
\begin{figure}[htbp]
    \centering\includegraphics[width=0.75\linewidth]{chap06/ThreeLensesFocalPlane.eps}
    \caption{利用焦平面追踪穿过三个透镜的光线。}
    \label{fig:6.44}
\end{figure}

\subsubsection{复合透镜}
我们在每个透镜元件均是薄透镜的前提下讨论复合透镜的性质。
\reffig{6.45}展示了两个透镜元件间的距离小于其任意一个的焦距时组成的复合透镜，
即$d<f_1$且$d<f_2$.其中$P_1'$是第一个透镜的实像，同时也是第二个透镜的虚物。
$P_1$则是第二个透镜的实像，也是整个复合透镜的像。
图中还标出了其他量。依据薄透镜公式，有
\begin{align}
    \frac{1}{s_{o1}}+\frac{1}{s_{i1}} & =\frac{1}{f_1}\, , \\
    \frac{1}{s_{o2}}+\frac{1}{s_{i2}} & =\frac{1}{f_2}\, .
\end{align}
并注意到$s_{o2}=d-s_{i1}$，带入整理得像距为
\begin{align}
    s_{i2}=\frac{f_2\left(d-\displaystyle\frac{s_{o1}f_1}{s_{o1}-f_1}\right)}{d-f_2-\displaystyle\frac{s_{o1}f_1}{s_{o1}-f_1}}\, .
\end{align}

复合透镜的横向放大率$M_T$是各元件横向放大率$M_{T1}$与$M_{T2}$之积，即
\begin{align}
    M_T=M_{T1}M_{T2}=\left(-\frac{s_{i1}}{s_{o1}}\right)\left(-\frac{s_{i2}}{s_{o2}}\right)=\frac{f_1s_{i2}}{d(s_{o1}-f_1)-s_{o1}f_1}\, .
\end{align}
\begin{figure}[htbp]
    \centering\includegraphics[scale=1]{chap06/TwoThinLenses01.eps}
    \caption{两个透镜元件间的距离小于任意一个的焦距。}
    \label{fig:6.45}
\end{figure}

\reffig{6.46}展示了两个薄透镜距离大于两者焦距之和的情况，即$d>f_1+f_2$.
其有关结论是类似的。
\begin{figure}[htbp]
    \centering\includegraphics[width=\linewidth]{chap06/TwoThinLenses02.eps}
    \caption{两个透镜元件间的距离大于两者焦距之和。}
    \label{fig:6.46}
\end{figure}


\begin{definition}
    光学系统最后一个界面与将其视作整体时的第二焦点间的距离称为\keyindex{后焦距}{back focal length}{focal length\ 焦距}(b.f.l.)。
    类似地，第一个界面的顶点到第一焦点的距离称为\keyindex{前焦距}{front focal length}{focal length\ 焦距}(f.f.l.)。
\end{definition}

在前面介绍的两个薄透镜复合的情况下（\reffig{6.47}），容易得到
\begin{align}
    \text{f.f.l.} & =\lim\limits_{s_{i2}\rightarrow \infty}{s_{o1}}=\frac{f_1(d-f_2)}{d-(f_1+f_2)}\, , \\
    \text{b.f.l.} & =\lim\limits_{s_{o1}\rightarrow \infty}{s_{i2}}=\frac{f_2(d-f_1)}{d-(f_1+f_2)}\, .
\end{align}
\begin{figure}[htbp]
    \centering\includegraphics[scale=1]{chap06/backfocallength.eps}
    \caption{一个薄凹透镜与一个薄凸透镜复合后的后焦距。}
    \label{fig:6.47}
\end{figure}

当$d\rightarrow 0$时，意味着透镜\keyindex{紧密}{in contact}{}贴合在一起，
例如一些\keyindex{消色差双合透镜}{achromatic doublets}{}。此时有
\begin{align}
    \text{f.f.l.}=\text{b.f.l.}=\frac{f_1f_2}{f_1+f_2}\, .
\end{align}

\begin{proposition}
    两个焦距分别为$f_1$和$f_2$的薄透镜紧密贴合后（仍视作薄透镜）
    的\keyindex{有效焦距}{effective focal length}{focal length\ 焦距}$f$为
    \begin{align}
        \frac{1}{f}=\frac{1}{f_1}+\frac{1}{f_2}\, .
    \end{align}
\end{proposition}
\begin{corollary}
    $N$个紧密贴合的薄透镜（仍视作薄透镜）的有效焦距$f$与每个透镜的焦距$f_i (i=1,2,\ldots,N)$的关系为
    \begin{align}
        \frac{1}{f}=\sum\limits_{i=1}^{N}{\frac{1}{f_i}}\, .
    \end{align}
\end{corollary}

\subsection{光圈}\label{sub:光圈}
\subsubsection{孔径光阑与视场光阑}
透镜的大小是有限的，这限制了能进入光学系统的光线范围。
此时透镜的有效直径就充当了\keyindex{光圈}{aperture}{}\sidenote{也可称作孔径或光阑。}。
如\reffig{6.48}，我们称像这样决定成像光量的透镜边缘或单独的快门等为\keyindex{孔径光阑}{aperture stop}{aperture\ 光圈}(A.S.)。
光学系统的孔径光阑是物理实体，它限制了从光轴上的物点发出且能进入系统的光束范围。
复杂相机中位于一部分元件后的可调叶片式快门通常就是孔径光阑（\reffig{6.52}），它决定了整组透镜聚集光线的能力。
限制系统所能成像的物体尺寸或角度范围的元件则称为\keyindex{视场光阑}{field stop}{aperture\ 光圈}(F.S.)，
它决定了视场范围（\reffig{6.48}）。相机中一般由胶片或CCD传感器充当视场光阑来限制成像平面。
因此孔径光阑控制从物点到共轭像点的光量，而视场光阑则决定是否彻底阻挡光线。
调大孔径光阑可以增加进光能量使得像的每一点都有更大辐照度，
而调大视场光阑则使原来被挡住的物体也能成像了。
\begin{figure}[htbp]
    \centering\includegraphics{chap06/ApertureStopAndFieldStop.eps}
    \caption{孔径光阑与视场光阑。}
    \label{fig:6.48}
\end{figure}

\subsubsection{入射光瞳与出射光瞳}
孔径光阑的像称为\keyindex{光瞳}{pupil}{}，它决定给定光线能否通过整个光学系统。
\begin{definition}
    从光轴上的物点通过孔径光阑之前的元件看到的该光阑的像称为\keyindex{入射光瞳}{entrance pupil}{pupil\ 光瞳}。
\end{definition}
\begin{definition}
    从光轴上的像点通过孔径光阑之后的元件看到的该光阑的像称为\keyindex{出射光瞳}{exit pupil}{pupil\ 光瞳}。
\end{definition}

\reffig{6.49}展示了孔径光阑分别在透镜前方和后方时的入射光瞳与出射光瞳，
光瞳的位置和大小均可以利用前文介绍的成像规律确定。
如果物与孔径光阑之间没有其他透镜，则孔径光阑本身就是入射光瞳（\reffig{6.49.1}）；
如果孔径光阑与像之间没有其他透镜，则孔径光阑本身就是出射光瞳（\reffig{6.49.2}）。
入射光瞳决定了能确实进入光学系统的光锥，出射光瞳则决定离开系统的光锥。
在这任意一种光锥范围之外的任何点源发出的光线都无法到达像平面。此外，光瞳和孔径光阑是共轭的。
当没有渐晕时，任意进入入射光瞳的发散光锥都能穿过孔径光阑并变为穿过出射光瞳的会聚光锥。

要强调的是，光轴上不同位置的物点可能对应着不同的光瞳和孔径光阑。
例如\reffig{6.49.1}中，若透镜更小一些，物体离透镜更近一些，
则通过光圈的光线可能超出了透镜有效直径范围，此时透镜本身就充当孔径光阑，光瞳也相应变化。
反之，若透镜更大一些，物体离透镜更远一些，则孔径光阑和光瞳都没变。

在设计光学系统时，光瞳的位置和尺寸十分重要。
例如使用一些观察设备时，人会把眼睛置于出射光瞳中心。
考虑到人眼瞳孔大小根据照明水平一般在2mm至8mm间，
所以夜视望远镜的出射光瞳通常至少为8mm，
而昼视设备使用3mm至4mm的出射光瞳就足够了。
高能步枪的瞄准镜则会使用更大的出射光瞳且在镜筒后端较远处，以避免后坐力伤到眼睛。

我们把离轴物点发出并穿过孔径光阑中心的光线称为\keyindex{主光线}{chief ray}{ray\ 光线}。
主光线进入光学系统时所沿直线会穿过入射光瞳中心$E_{np}$，
且离开系统时所沿直线会穿过出射光瞳中心$E_{xp}$.
它对于校正透镜设计的像差十分重要。
\begin{figure}[htbp]
    \centering
    \subfloat[孔径光阑在前方。]{\includegraphics[scale=1]{chap06/FrontApertureStop.eps}\label{fig:6.49.1}}\\
    \subfloat[孔径光阑在后方。]{\includegraphics[scale=1]{chap06/EntrancePupilAndExitPupil.eps}\label{fig:6.49.2}}
    \caption{入射光瞳与出射光瞳。}
    \label{fig:6.49}
\end{figure}

\reffig{6.50}则展示了三透镜系统的光瞳和孔径光阑，
其中标注出了两种光线，一种是主光线，另一种则称为\keyindex{边缘光线}{marginal ray}{ray\ 光线}。
边缘光线从光轴上的物点出发并射向入射光瞳（或孔径光阑）的边缘。
\begin{figure}[htbp]
    \centering\includegraphics{chap06/PupilsAndStopsForAThree-LensSystem.eps}
    \caption{三透镜系统的光瞳和孔径光阑。}
    \label{fig:6.50}
\end{figure}

当不清楚哪一个元件实际充当孔径光阑时，须让系统的每个元件被其左边的元件组合成像。
光轴上某一物点对应的张角范围最小的像即为入射光瞳。
该像对应的元件即为该物点相应的孔径光阑。

注意\reffig{6.51}中，当物点在光轴上时，透镜$L_1$的边缘充当孔径光阑；
当物点远离光轴时，到达成像平面的对应光锥变窄，有效孔径光阑变小。
像这样图像靠近边缘的点会变淡（暗）的现象称为\keyindex{渐晕}{vignetting}{}。
\begin{figure}[htbp]
    \centering\includegraphics[width=\linewidth]{chap06/Vignetting.eps}
    \caption{渐晕。}
    \label{fig:6.51}
\end{figure}

\subsubsection{相对孔径与$f$数}
当我们使用透镜对较远处的物体成像时，其上某一极小区域发出
并能进入透镜的光能正比于透镜的面积，或说正比于入射光瞳的面积。
不过如果光源是极窄的激光束，则这一结论不成立。
我们排除这类特殊情况，并忽略反射损耗、像差等，
则入射光能会分布到相应的成像区域（\reffig{6.52}），其辐照度反比于成像面积。
考虑到当入射光瞳是圆形时，其面积正比于直径$D$.
而成像面积则是横向维度的平方，故正比于焦距的平方。
因此成像平面的辐照度正比于$\displaystyle\left(\frac{D}{f}\right)^2$.
我们称$\displaystyle\frac{D}{f}$为\keyindex{相对孔径}{relative aperture}{aperture\ 光圈}，
称其倒数为\keyindex{$f$数}{$f$-number}{}或\keyindex{焦比}{focal ratio}{}，记作$f/\#$，即
\begin{align}
    f/\#=\frac{f}{D}\, .
\end{align}
例如光圈25mm、焦距50mm的透镜的$f$数为2，记作$f/2$.
$f$数越小进光量越大。\reffig{6.53}(a)是一个透镜后接可调叶片式光圈
时$f$数分别取2和4的情况。
\begin{figure}[htbp]
    \centering\includegraphics{chap06/ALarge-FormatCamera.eps}
    \caption{相机光学系统构造示意图。}
    \label{fig:6.52}
\end{figure}
\begin{figure}[htbp]
    \centering\includegraphics{chap06/F-number.eps}
    \caption{(a)遮挡透镜以改变$f$数。(b)镜头的可调光圈设置。}
    \label{fig:6.53}
\end{figure}

通常我们用焦距和最大光圈来指定透镜，例如镜筒上写着“50mm，$f/1.4$”。
因为摄影曝光时间正比于$f$数的平方，所以$f$数有时也称为透镜的\keyindex{速度}{speed}{}。
例如$f/1.4$的透镜是$f/2$的两倍快。
镜头光圈的$f$数常标为1、1.4、2、2.8、4、5.6、8、11、16和22等，此时它的最大相对孔径为$f/1$.
这些相邻光圈设置的$f$数依次扩大为$\sqrt{2}$倍（再舍入），因此辐照度依次减半。
所以相机用$f/1.4$曝光$\displaystyle\frac{1}{500}$秒、用$f/2$曝光$\displaystyle\frac{1}{250}$秒、
用$f/2.8$曝光$\displaystyle\frac{1}{125}$秒的进光量是相同的。
